<div class="top-container">

  <%# --- Ê§úÁ¥¢„Ç®„É™„Ç¢ --- %>
  <div class="search-area">
    <%= form_with(url: root_path, method: :get, local: true, class: "search-form") do |f| %>
      <%= f.text_field :search, value: params[:search], placeholder: "Â∫óÂêçÊ§úÁ¥¢...", class: "search-input" %>
      <%= f.select :category, [['„Ç®„É™„Ç¢ÈÅ∏Êäû', '']], {}, class: "search-select" %>
      <%= f.submit "Ê§úÁ¥¢", name: nil, class: "search-btn" %>
    <% end %>
  </div>

  <%# --- ‰∏ÄË¶ßË°®Á§∫„Ç®„É™„Ç¢ --- %>
  <div class="shop-list">
    <% @shops.each do |shop| %>
      <div class="shop-card">
        <div class="shop-content">
          
          <%# Â∑¶ÂÅ¥ÔºöÁîªÂÉè %>
          <div class="shop-image">
            <% if shop.image.attached? %>
              <%= image_tag shop.image, class: "shop-img-tag" %>
            <% else %>
              <div class="no-image-text">No Image</div>
            <% end %>
          </div>

          <%# Âè≥ÂÅ¥ÔºöÊÉÖÂ†± %>
          <div class="shop-info">
            <div class="shop-name-box">
              <%= shop.name %>
            </div>
            
            <% if session[:user_id] %>
              <div class="shop-edit-area">
                <%= link_to 'Á∑®ÈõÜ„Åô„Çã', edit_shop_path(shop), class: "edit-btn" %>
              </div>
            <% end %>
            
            <div class="shop-like-area">
              <% if session[:user_id] %>
                <%# --- „É≠„Ç∞„Ç§„É≥‰∏≠ÔºàÊ©üËÉΩ„ÅÇ„ÇäÔºâ --- %>
                <% if shop.likes.exists?(user_id: session[:user_id]) %>
                  <%# Ëß£Èô§„Éú„Çø„É≥ %>
                  <%= button_to shop_likes_path(shop), method: :delete, class: "like-btn liked" do %>
                    Ëß£Èô§ <span class="thumbs-up">üëç</span>
                    <span class="like-count"><%= shop.likes.count %></span>
                  <% end %>
                <% else %>
                  <%# ÁôªÈå≤„Éú„Çø„É≥ %>
                  <%= button_to shop_likes_path(shop), method: :post, class: "like-btn" do %>
                    „ÅÑ„ÅÑ„Å≠ <span class="thumbs-up">üëç</span>
                    <span class="like-count"><%= shop.likes.count %></span>
                  <% end %>
                <% end %>

              <% else %>
                <%# --- „É≠„Ç∞„Ç¢„Ç¶„Éà‰∏≠ÔºàÊ©üËÉΩ„Å™„Åó„ÉªÈ£æ„Çä„Éú„Çø„É≥Ôºâ --- %>
                <button type="button" class="like-btn">
                  „ÅÑ„ÅÑ„Å≠ <span class="thumbs-up">üëç</span>
                  <span class="like-count"><%= shop.likes.count %></span>
                </button>
              <% end %>
            </div>
            
          </div>
        </div>

        <%# ‰∏ãÈÉ®Ôºö„É¨„Éì„É•„Éº %>
        <div class="shop-review-bar">
          <%= link_to "„É¨„Éì„É•„Éº", shop_path(shop), class: "review-link" %>
        </div>
      </div>
    <% end %>
  </div>

  <%# Êñ∞Ë¶èËøΩÂä† %>
  <% if session[:user_id] %>
    <div class="bottom-action">
      <%= link_to 'Êñ∞Ë¶èËøΩÂä†', new_shop_path, class: "new-shop-link" %>
    </div>
  <% end %>
</div>